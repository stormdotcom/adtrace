<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AdTrace</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&family=Roboto+Mono:wght@400;500;700&display=swap');

  :root {
    --bg: #f8f9fa;
    --bg-white: #ffffff;
    --bg-hover: #f1f3f4;
    --bg-active: #e8f0fe;
    --border: #dadce0;
    --border-light: #e8eaed;
    --text: #202124;
    --text-secondary: #5f6368;
    --text-tertiary: #80868b;
    --blue: #1a73e8;
    --blue-light: #e8f0fe;
    --blue-dark: #1967d2;
    --red: #ea4335;
    --red-light: #fce8e6;
    --yellow: #fbbc04;
    --yellow-light: #fef7e0;
    --green: #34a853;
    --green-light: #e6f4ea;
    --purple: #a142f4;
    --purple-light: #f3e8fd;
    --orange: #fa903e;
    --orange-light: #feefe3;
    --font-sans: 'Google Sans', 'Segoe UI', Roboto, sans-serif;
    --font-mono: 'Roboto Mono', 'Consolas', monospace;
    --shadow-1: 0 1px 2px 0 rgba(60,64,67,.3), 0 1px 3px 1px rgba(60,64,67,.15);
    --shadow-2: 0 1px 3px 0 rgba(60,64,67,.3), 0 4px 8px 3px rgba(60,64,67,.15);
    --radius: 8px;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    width: 400px;
    min-height: 520px;
    background: var(--bg);
    color: var(--text);
    font-family: var(--font-sans);
    font-size: 13px;
    overflow-x: hidden;
  }

  /* === HEADER === */
  .header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    background: var(--bg-white);
    border-bottom: 1px solid var(--border-light);
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .logo-icon { width: 24px; height: 24px; }
  .logo-icon svg { width: 100%; height: 100%; }
  .logo-text {
    font-family: var(--font-sans);
    font-size: 16px;
    font-weight: 700;
    color: var(--text);
  }
  .logo-text span { color: var(--blue); }

  .header-controls {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  /* Icon buttons */
  .icon-btn {
    width: 32px; height: 32px;
    border: none;
    border-radius: 50%;
    background: transparent;
    color: var(--text-secondary);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background .15s;
  }
  .icon-btn:hover { background: var(--bg-hover); }
  .icon-btn.active { background: var(--blue-light); color: var(--blue); }
  .icon-btn svg { width: 18px; height: 18px; }

  /* Toggle */
  .toggle {
    position: relative;
    width: 34px; height: 14px;
    display: inline-block;
  }
  .toggle input { display: none; }
  .toggle-track {
    position: absolute;
    inset: 0;
    background: #b0bec5;
    border-radius: 7px;
    cursor: pointer;
    transition: background .2s;
  }
  .toggle-thumb {
    position: absolute;
    top: -3px; left: -1px;
    width: 20px; height: 20px;
    background: #fafafa;
    border-radius: 50%;
    box-shadow: 0 1px 3px rgba(0,0,0,.3);
    transition: transform .2s, background .2s;
    pointer-events: none;
  }
  .toggle input:checked + .toggle-track { background: #a8c7fa; }
  .toggle input:checked + .toggle-track + .toggle-thumb {
    transform: translateX(16px);
    background: var(--blue);
  }

  /* === FP WARNING === */
  .fp-warning-bar {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
    background: var(--orange-light);
    border-bottom: 1px solid #f9cb9c;
    font-size: 12px;
    color: #b06000;
  }
  .fp-warning-bar.hidden { display: none; }
  .fp-warning-bar svg { width: 16px; height: 16px; flex-shrink: 0; color: var(--orange); }
  .fp-dismiss-btn {
    margin-left: auto;
    background: none;
    border: none;
    color: #b06000;
    cursor: pointer;
    font-size: 18px;
    line-height: 1;
  }

  /* === STATS BAR === */
  .stats-bar {
    display: flex;
    gap: 8px;
    padding: 12px 16px;
    background: var(--bg-white);
    border-bottom: 1px solid var(--border-light);
  }
  .stat-card {
    flex: 1;
    background: var(--bg);
    border-radius: 8px;
    padding: 8px;
    text-align: center;
  }
  .stat-num {
    font-family: var(--font-sans);
    font-size: 18px;
    font-weight: 700;
    line-height: 1.2;
    display: block;
  }
  .stat-num.blue { color: var(--blue); }
  .stat-num.yellow { color: #e37400; }
  .stat-num.red { color: var(--red); }
  .stat-num.purple { color: var(--purple); }
  .stat-num.green { color: var(--green); }
  .stat-label {
    font-size: 10px;
    color: var(--text-tertiary);
    text-transform: uppercase;
    letter-spacing: .04em;
    margin-top: 1px;
    display: block;
    font-weight: 500;
  }

  /* === TABS === */
  .tabs {
    display: flex;
    background: var(--bg-white);
    border-bottom: 1px solid var(--border-light);
    padding: 0 8px;
  }
  .tab {
    flex: 1;
    padding: 10px 8px 8px;
    text-align: center;
    font-family: var(--font-sans);
    font-size: 12px;
    font-weight: 500;
    color: var(--text-secondary);
    cursor: pointer;
    border: none;
    background: none;
    border-bottom: 2px solid transparent;
    transition: all .15s;
  }
  .tab:hover { color: var(--blue); }
  .tab.active {
    color: var(--blue);
    border-bottom-color: var(--blue);
  }

  /* === PANELS === */
  .panel { display: none; }
  .panel.active { display: block; }

  /* Log panel */
  .log-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 16px;
    background: var(--bg-white);
    border-bottom: 1px solid var(--border-light);
  }
  .log-filter { display: flex; gap: 4px; }
  .filter-chip {
    padding: 4px 10px;
    border-radius: 16px;
    font-family: var(--font-sans);
    font-size: 11px;
    font-weight: 500;
    cursor: pointer;
    border: 1px solid var(--border);
    transition: all .12s;
    background: var(--bg-white);
    color: var(--text-secondary);
  }
  .filter-chip:hover { background: var(--bg-hover); }
  .filter-chip.active {
    background: var(--blue-light);
    border-color: var(--blue);
    color: var(--blue);
  }
  .filter-chip[data-cat="ad"].active { background: var(--red-light); border-color: var(--red); color: var(--red); }
  .filter-chip[data-cat="tracker"].active { background: var(--yellow-light); border-color: #e37400; color: #e37400; }
  .filter-chip[data-cat="social"].active { background: var(--purple-light); border-color: var(--purple); color: var(--purple); }
  .filter-chip[data-cat="fp"].active { background: var(--orange-light); border-color: var(--orange); color: #b06000; }

  .clear-btn {
    font-family: var(--font-sans);
    font-size: 11px;
    color: var(--text-tertiary);
    background: none;
    border: none;
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 4px;
    transition: all .12s;
  }
  .clear-btn:hover { color: var(--red); background: var(--red-light); }

  .log-list {
    max-height: 280px;
    overflow-y: auto;
  }
  .log-list::-webkit-scrollbar { width: 6px; }
  .log-list::-webkit-scrollbar-track { background: var(--bg); }
  .log-list::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

  .log-entry {
    display: flex;
    align-items: flex-start;
    padding: 8px 16px;
    gap: 10px;
    cursor: pointer;
    transition: background .1s;
    border-bottom: 1px solid var(--border-light);
    background: var(--bg-white);
  }
  .log-entry:hover { background: var(--bg-hover); }
  .log-entry.fp-entry { background: #fff8f0; }

  .entry-cat {
    width: 8px; height: 8px;
    border-radius: 50%;
    margin-top: 5px;
    flex-shrink: 0;
  }
  .entry-cat.ad { background: var(--red); }
  .entry-cat.tracker { background: var(--yellow); }
  .entry-cat.social { background: var(--purple); }
  .entry-cat.other { background: var(--text-tertiary); }

  .entry-info { flex: 1; min-width: 0; }
  .entry-url {
    font-family: var(--font-mono);
    font-size: 11px;
    color: var(--text);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.3;
  }
  .entry-meta {
    display: flex;
    gap: 4px;
    margin-top: 3px;
    flex-wrap: wrap;
  }
  .meta-tag {
    font-family: var(--font-mono);
    font-size: 10px;
    padding: 1px 6px;
    border-radius: 4px;
    font-weight: 500;
  }
  .meta-tag.type { background: var(--bg); color: var(--text-secondary); }
  .meta-tag.rule { background: var(--blue-light); color: var(--blue); }
  .meta-tag.time { background: transparent; color: var(--text-tertiary); }
  .meta-tag.intent { border-radius: 4px; }
  .meta-tag.intent.ad-network { background: var(--red-light); color: var(--red); }
  .meta-tag.intent.analytics { background: var(--yellow-light); color: #e37400; }
  .meta-tag.intent.session-replay { background: #fce4ec; color: #c2185b; }
  .meta-tag.intent.fingerprinting { background: #fbe9e7; color: #d84315; }
  .meta-tag.intent.crypto-miner { background: var(--red-light); color: #c62828; }
  .meta-tag.intent.payment-sdk { background: var(--green-light); color: var(--green); }
  .meta-tag.intent.cdn { background: #e0f7fa; color: #00838f; }
  .meta-tag.intent.social { background: var(--purple-light); color: var(--purple); }
  .meta-tag.intent.unknown { background: var(--bg); color: var(--text-tertiary); }
  .meta-tag.intent.custom { background: var(--blue-light); color: var(--blue); }
  .meta-tag.fp-tag { background: var(--orange-light); color: #b06000; font-weight: 700; }

  .entry-list {
    font-family: var(--font-mono);
    font-size: 10px;
    color: var(--text-tertiary);
    margin-top: 2px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .entry-actions { display: flex; gap: 2px; flex-shrink: 0; }
  .entry-action-btn {
    width: 24px; height: 24px;
    border: 1px solid var(--border);
    border-radius: 50%;
    background: var(--bg-white);
    color: var(--text-tertiary);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all .12s;
    font-size: 11px;
  }
  .entry-action-btn:hover { background: var(--bg-hover); }
  .entry-action-btn.allow:hover { background: var(--green-light); color: var(--green); border-color: var(--green); }
  .entry-action-btn.block:hover { background: var(--red-light); color: var(--red); border-color: var(--red); }

  /* Empty state */
  .empty-state {
    padding: 40px 20px;
    text-align: center;
    color: var(--text-tertiary);
  }
  .empty-state svg { width: 40px; height: 40px; margin-bottom: 10px; color: var(--border); }
  .empty-state p { font-size: 12px; line-height: 1.6; }

  /* === DOMAINS PANEL === */
  .current-domain {
    padding: 12px 16px;
    background: var(--bg-white);
    border-bottom: 1px solid var(--border-light);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .domain-info { display: flex; align-items: center; gap: 10px; }
  .domain-status-dot {
    width: 10px; height: 10px;
    border-radius: 50%;
    background: var(--green);
    flex-shrink: 0;
  }
  .domain-status-dot.blocked { background: var(--red); }
  .domain-status-dot.allowed { background: var(--blue); }
  .domain-name {
    font-family: var(--font-mono);
    font-size: 13px;
    color: var(--text);
    font-weight: 500;
  }
  .domain-sub { font-size: 11px; color: var(--text-tertiary); margin-top: 1px; }

  .domain-actions { display: flex; gap: 6px; }
  .domain-btn {
    padding: 6px 14px;
    border-radius: 16px;
    font-family: var(--font-sans);
    font-size: 11px;
    font-weight: 500;
    cursor: pointer;
    border: 1px solid var(--border);
    background: var(--bg-white);
    color: var(--text-secondary);
    transition: all .12s;
  }
  .domain-btn:hover { background: var(--bg-hover); }
  .domain-btn.allow-btn:hover { background: var(--green-light); border-color: var(--green); color: var(--green); }
  .domain-btn.block-btn:hover { background: var(--red-light); border-color: var(--red); color: var(--red); }
  .domain-btn.active-allow { background: var(--green-light); border-color: var(--green); color: var(--green); }
  .domain-btn.active-block { background: var(--red-light); border-color: var(--red); color: var(--red); }

  .overrides-list { padding: 4px 0; }
  .override-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 16px;
    border-bottom: 1px solid var(--border-light);
    background: var(--bg-white);
  }
  .override-domain { font-family: var(--font-mono); font-size: 12px; color: var(--text); }
  .override-mode {
    display: flex; align-items: center; gap: 6px;
    font-size: 11px; font-weight: 500;
  }
  .override-mode.allow { color: var(--green); }
  .override-mode.allow::before { content: ''; display: inline-block; width: 6px; height: 6px; border-radius: 50%; background: var(--green); }
  .override-mode.block { color: var(--red); }
  .override-mode.block::before { content: ''; display: inline-block; width: 6px; height: 6px; border-radius: 50%; background: var(--red); }
  .remove-override { background: none; border: none; color: var(--text-tertiary); cursor: pointer; font-size: 16px; padding: 2px 4px; border-radius: 50%; transition: all .12s; }
  .remove-override:hover { color: var(--red); background: var(--red-light); }
  .local-label { font-size: 9px; color: var(--green); margin-left: 6px; background: var(--green-light); padding: 2px 6px; border-radius: 4px; font-weight: 500; }
  .no-overrides { padding: 24px; text-align: center; font-size: 12px; color: var(--text-tertiary); }

  /* === RULES PANEL === */
  .rules-panel { padding: 16px; }
  .rules-panel h3 {
    font-family: var(--font-sans);
    font-size: 12px;
    color: var(--text-secondary);
    font-weight: 500;
    margin-bottom: 8px;
  }
  .rule-editor {
    background: var(--bg-white);
    border: 1px solid var(--border-light);
    border-radius: var(--radius);
    padding: 12px;
    margin-bottom: 16px;
  }
  .rule-input {
    width: 100%;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 8px 10px;
    font-family: var(--font-mono);
    font-size: 11px;
    color: var(--text);
    outline: none;
    resize: vertical;
    min-height: 60px;
    transition: border-color .15s;
    margin-bottom: 8px;
  }
  .rule-input:focus { border-color: var(--blue); box-shadow: 0 0 0 2px var(--blue-light); }
  .rule-input::placeholder { color: var(--text-tertiary); }

  .rule-actions { display: flex; gap: 8px; justify-content: flex-end; }
  .btn-primary {
    padding: 6px 16px;
    background: var(--blue);
    border: none;
    border-radius: 16px;
    color: #fff;
    font-family: var(--font-sans);
    font-size: 11px;
    font-weight: 500;
    cursor: pointer;
    transition: all .12s;
  }
  .btn-primary:hover { background: var(--blue-dark); box-shadow: var(--shadow-1); }
  .btn-secondary {
    padding: 6px 16px;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: 16px;
    color: var(--text-secondary);
    font-family: var(--font-sans);
    font-size: 11px;
    font-weight: 500;
    cursor: pointer;
    transition: all .12s;
  }
  .btn-secondary:hover { background: var(--bg-hover); }

  .rule-hint {
    font-size: 11px;
    color: var(--text-tertiary);
    line-height: 1.6;
    padding: 8px;
    background: var(--bg);
    border-radius: 6px;
    margin-top: 6px;
  }
  .rule-hint code { color: var(--blue); font-family: var(--font-mono); font-size: 10px; background: var(--blue-light); padding: 1px 4px; border-radius: 3px; }

  /* === REPORT PANEL === */
  .report-panel { padding: 16px; }
  .report-summary {
    background: var(--bg-white);
    border: 1px solid var(--border-light);
    border-radius: var(--radius);
    padding: 0;
    margin-bottom: 12px;
    overflow: hidden;
  }
  .report-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    border-bottom: 1px solid var(--border-light);
  }
  .report-row:last-child { border-bottom: none; }
  .report-key { font-size: 12px; color: var(--text-secondary); }
  .report-val { font-size: 12px; color: var(--text); font-weight: 700; }

  .report-domains { margin-bottom: 12px; }
  .rdomain-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 6px 12px;
    border-bottom: 1px solid var(--border-light);
    background: var(--bg-white);
  }
  .rdomain-item:first-child { border-radius: var(--radius) var(--radius) 0 0; }
  .rdomain-item:last-child { border-radius: 0 0 var(--radius) var(--radius); border-bottom: none; }
  .rdomain-name { font-family: var(--font-mono); font-size: 11px; color: var(--text); }
  .rdomain-count {
    font-family: var(--font-mono);
    font-size: 11px;
    font-weight: 700;
    padding: 2px 8px;
    border-radius: 12px;
  }
  .rdomain-count.high { background: var(--red-light); color: var(--red); }
  .rdomain-count.med { background: var(--yellow-light); color: #e37400; }
  .rdomain-count.low { background: var(--blue-light); color: var(--blue); }

  .export-btn {
    width: 100%;
    padding: 10px;
    background: var(--bg-white);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    color: var(--text-secondary);
    font-family: var(--font-sans);
    font-size: 12px;
    font-weight: 500;
    cursor: pointer;
    transition: all .15s;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
  }
  .export-btn:hover { background: var(--bg-hover); border-color: var(--blue); color: var(--blue); }
  .export-btn + .export-btn { margin-top: 8px; }
  .export-btn svg { width: 16px; height: 16px; }

  /* Footer */
  .footer {
    padding: 10px 16px;
    background: var(--bg-white);
    border-top: 1px solid var(--border-light);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .footer-left { font-size: 11px; color: var(--text-tertiary); }
  .footer-left span { color: var(--blue); font-weight: 500; }
  .options-link {
    font-size: 11px;
    color: var(--blue);
    cursor: pointer;
    background: none;
    border: none;
    font-weight: 500;
    font-family: var(--font-sans);
    transition: color .12s;
  }
  .options-link:hover { color: var(--blue-dark); }

  /* Simulate bar */
  .sim-bar {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
    background: var(--yellow-light);
    border-bottom: 1px solid #f9cb9c;
    font-size: 12px;
    color: #7c4a03;
  }
  .sim-bar.hidden { display: none; }
  .sim-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--yellow); animation: pulse 1s ease infinite; }
  @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .3; } }
  .sim-close { margin-left: auto; background: none; border: none; color: #7c4a03; cursor: pointer; font-size: 16px; }

  .panel-scroll { max-height: 340px; overflow-y: auto; }
  .panel-scroll::-webkit-scrollbar { width: 6px; }
  .panel-scroll::-webkit-scrollbar-track { background: var(--bg); }
  .panel-scroll::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

  @keyframes flash { 0% { opacity: 1; } 100% { } }
  .stat-updated { animation: flash .3s ease-out; }
  #ruleStatus { font-size: 11px; color: var(--green); padding: 6px 0; display: none; }
  .section-label { padding: 8px 16px 4px; font-size: 11px; color: var(--text-tertiary); font-weight: 500; }
</style>
</head>
<body>

<!-- Header -->
<div class="header">
  <div class="logo">
    <div class="logo-icon">
      <svg viewBox="0 0 24 24" fill="none">
        <path d="M12 2L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-3z" fill="#1a73e8" opacity=".12"/>
        <path d="M12 2L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-3z" stroke="#1a73e8" stroke-width="1.5" fill="none"/>
        <path d="M9 12l2 2 4-4" stroke="#1a73e8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </div>
    <span class="logo-text">Ad<span>Trace</span></span>
  </div>
  <div class="header-controls">
    <button class="icon-btn" id="inspectBtn" title="Inspect element blocking">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
      </svg>
    </button>
    <button class="icon-btn" id="devModeBtn" title="Dev overlay">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/>
      </svg>
    </button>
    <label class="toggle">
      <input type="checkbox" id="masterToggle" checked>
      <div class="toggle-track"></div>
      <div class="toggle-thumb"></div>
    </label>
  </div>
</div>

<!-- Simulate bar -->
<div class="sim-bar hidden" id="simBar">
  <div class="sim-dot"></div>
  Simulating user view — ads visible
  <button class="sim-close" id="simClose">&#x2715;</button>
</div>

<!-- False Positive Warning -->
<div class="fp-warning-bar hidden" id="fpWarningBar">
  <svg viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
  <span><strong id="fpCount">0</strong> blocked requests may break page functionality</span>
  <button class="fp-dismiss-btn" id="fpDismiss">&#x2715;</button>
</div>

<!-- Stats -->
<div class="stats-bar">
  <div class="stat-card">
    <span class="stat-num blue" id="statBlocked">0</span>
    <span class="stat-label">Blocked</span>
  </div>
  <div class="stat-card">
    <span class="stat-num yellow" id="statTrackers">0</span>
    <span class="stat-label">Trackers</span>
  </div>
  <div class="stat-card">
    <span class="stat-num red" id="statAds">0</span>
    <span class="stat-label">Ads</span>
  </div>
  <div class="stat-card">
    <span class="stat-num purple" id="statSocial">0</span>
    <span class="stat-label">Social</span>
  </div>
  <div class="stat-card">
    <span class="stat-num green" id="statSavings">0ms</span>
    <span class="stat-label">Saved</span>
  </div>
</div>

<!-- Tabs -->
<div class="tabs">
  <button class="tab active" data-panel="log">Log</button>
  <button class="tab" data-panel="domains">Domains</button>
  <button class="tab" data-panel="rules">Rules</button>
  <button class="tab" data-panel="report">Report</button>
</div>

<!-- LOG PANEL -->
<div class="panel active" id="panel-log">
  <div class="log-header">
    <div class="log-filter">
      <span class="filter-chip active" data-cat="all">All</span>
      <span class="filter-chip" data-cat="ad">Ads</span>
      <span class="filter-chip" data-cat="tracker">Track</span>
      <span class="filter-chip" data-cat="social">Social</span>
      <span class="filter-chip" data-cat="fp">Warnings</span>
    </div>
    <button class="clear-btn" id="clearLog">Clear</button>
  </div>
  <div class="log-list" id="logList">
    <div class="empty-state">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 2L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-3z"/></svg>
      <p>No blocked requests yet.<br>Navigate to a page to start tracing.</p>
    </div>
  </div>
</div>

<!-- DOMAINS PANEL -->
<div class="panel" id="panel-domains">
  <div class="current-domain" id="currentDomainRow">
    <div class="domain-info">
      <div class="domain-status-dot" id="domainStatusDot"></div>
      <div>
        <div class="domain-name" id="currentDomainName">&#x2014;</div>
        <div class="domain-sub" id="currentDomainSub">Current page domain</div>
      </div>
    </div>
    <div class="domain-actions">
      <button class="domain-btn allow-btn" id="allowDomainBtn">Allow</button>
      <button class="domain-btn block-btn" id="blockDomainBtn">Block</button>
    </div>
  </div>
  <div class="panel-scroll">
    <div class="section-label">Domain Overrides</div>
    <div id="overridesList">
      <div class="no-overrides">No custom overrides. Localhost is auto-whitelisted.</div>
    </div>
  </div>
</div>

<!-- RULES PANEL -->
<div class="panel" id="panel-rules">
  <div class="rules-panel panel-scroll">
    <h3>Custom Network Rules</h3>
    <div class="rule-editor">
      <textarea class="rule-input" id="networkRuleInput" placeholder="||example.com^&#10;||ads.example.com/banner$image"></textarea>
      <div class="rule-hint">
        <code>||domain.com^</code> blocks entire domain<br>
        <code>||url.com/path$type</code> filter by resource type
      </div>
      <div class="rule-actions" style="margin-top:8px">
        <button class="btn-secondary" id="previewRuleBtn">Preview</button>
        <button class="btn-primary" id="saveRuleBtn">Apply Rule</button>
      </div>
    </div>

    <h3>Custom Cosmetic Rules</h3>
    <div class="rule-editor">
      <textarea class="rule-input" id="cosmeticRuleInput" placeholder="##.ad-banner&#10;example.com##.promoted-post"></textarea>
      <div class="rule-hint">
        <code>##.selector</code> hides elements globally<br>
        <code>domain.com##.selector</code> hides on specific domain
      </div>
      <div class="rule-actions" style="margin-top:8px">
        <button class="btn-primary" id="saveCosmeticBtn">Apply Cosmetic</button>
      </div>
    </div>
    <div id="ruleStatus"></div>
  </div>
</div>

<!-- REPORT PANEL -->
<div class="panel" id="panel-report">
  <div class="report-panel panel-scroll">
    <div class="report-summary">
      <div class="report-row"><span class="report-key">Page</span><span class="report-val" id="reportPage">&#x2014;</span></div>
      <div class="report-row"><span class="report-key">Total Blocked</span><span class="report-val" id="reportTotal">0</span></div>
      <div class="report-row"><span class="report-key">Ad Networks</span><span class="report-val" id="reportAds">0</span></div>
      <div class="report-row"><span class="report-key">Trackers</span><span class="report-val" id="reportTrackers">0</span></div>
      <div class="report-row"><span class="report-key">Social Pixels</span><span class="report-val" id="reportSocial">0</span></div>
      <div class="report-row"><span class="report-key">Est. Time Saved</span><span class="report-val" id="reportSavings" style="color: var(--green);">0ms</span></div>
    </div>

    <div class="section-label" style="padding-left:0;">Blocked Domains</div>
    <div class="report-domains" id="reportDomains">
      <div class="rdomain-item" style="color: var(--text-tertiary); font-size: 12px;">No data — visit a page first</div>
    </div>

    <button class="export-btn" id="exportJsonBtn">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
      Export JSON Report
    </button>
    <button class="export-btn" id="exportCsvBtn">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
      Export CSV Report
    </button>
  </div>
</div>

<!-- Footer -->
<div class="footer">
  <div class="footer-left">AdTrace <span>v1.0</span></div>
  <div style="display:flex; gap: 12px;">
    <button class="options-link" id="simulateBtn">Simulate User</button>
    <button class="options-link" id="optionsBtn">Settings</button>
  </div>
</div>

<script src="popup.js"></script>
</body>
</html>
